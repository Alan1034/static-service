import{o as r,e as f,f as V,r as m,g as d,h as R,F as T,j as O,k as M,l as B,w as i,m as S,u as L,n as A,p as y,t as U,c as j,q,s as z,E as N,v as G,x as J}from"./vendor-fb665583.js";import{_ as C}from"./index-e581c75f.js";const K={props:{activeIndex:String},methods:{handleSelect(a,t){this.$emit("update:activeIndex",a)}}},Q={class:"head"};function W(a,t,n,o,e,l){return r(),f("h1",Q,"静态文件上传下载服务")}const X=C(K,[["render",W],["__scopeId","data-v-a954f5b6"],["__file","D:/work/static-service/front/src/layouts/HeaderMenu.vue"]]),Y={methods:{handleOpen(a,t){console.log(a,t)},handleClose(a,t){console.log(a,t)}}};function Z(a,t,n,o,e,l){return r(),f("p",null,[V(` <router-link to="/home">HOME</router-link>\r
    <br />\r
    <router-link to="/colorlibrary">colorlibrary</router-link> `)])}const ee=C(Y,[["render",Z],["__file","D:/work/static-service/front/src/layouts/AsideMenu.vue"]]),te={data(){return{activeIndex:"1",mainHeight:window.innerHeight-61}},name:"MainLayout",components:{HeaderMenu:X,AsideMenu:ee}};function ae(a,t,n,o,e,l){const _=m("aside-menu"),v=m("header-menu");return r(),f(T,null,[d(_,{activeIndex:e.activeIndex,"onUpdate:activeIndex":t[0]||(t[0]=h=>e.activeIndex=h)},null,8,["activeIndex"]),d(v,{activeIndex:e.activeIndex,"onUpdate:activeIndex":t[1]||(t[1]=h=>e.activeIndex=h)},null,8,["activeIndex"]),R(a.$slots,"default")],64)}const ne=C(te,[["render",ae],["__file","D:/work/static-service/front/src/layouts/MainLayout.vue"]]),oe={class:"ImageSelecter-content"},se={class:"custom-tree-node"},ce=["onClick"],re={class:"image-slot"},le=O({__name:"index",setup(a,{expose:t}){const n={label:"name",isLeaf:"isLeaf",children:"children"},o=M(),e=M(),l=M([{name:"文件根目录"}]),_="/static-service/assets",v=B(()=>{var c,s,u;return`${_}${(c=o.value)!=null&&c.basePath?(s=o.value)==null?void 0:s.basePath.replace(/\\/gm,"/"):""}/${((u=o.value)==null?void 0:u.name)||""}`}),h=B(()=>v.value),F=async(c,s)=>{const{data:u,level:g}=c;if(g===0)return s([{name:"文件根目录"}]);const{path:x="",name:k=""}=u;e.value=!0;const b=await fetch(`${_}/assetsDir?filePath=${x}&name=${k==="文件根目录"?"":k}`,{method:"get"}),I=await b.json();e.value=!1;const{data:p={}}=I,{status:w=200}=b;if(w!==200){const{message:D=""}=I;N(D)}if(p){const{fileObjs:D=[]}=p;s(D)}else s([])},H=async(c,s,u,g)=>{o.value=c},$=()=>{e.value=!0,o.value=null,l.value=[...l.value],e.value=!1},P=(c,s)=>{console.log(c),console.log(s)},E=async(c,s)=>{const{path:u="",name:g=""}=s;e.value=!0;const x=await fetch(`${_}?filePath=${u}&name=${g==="文件根目录"?"":g}`,{method:"delete"}),k=await x.json();e.value=!1;const{message:b=""}=k;N(b);const{status:I=200}=x;I===200&&$()};return t({imgData:o,refresh:$}),(c,s)=>{const u=m("el-button"),g=m("el-popconfirm"),x=m("el-tree"),k=m("el-icon"),b=m("el-image"),I=m("el-card");return r(),f("div",null,[d(u,{class:"refresh",type:"primary","loading-icon":L(A),loading:e.value,onClick:$},{default:i(()=>[S("刷新")]),_:1},8,["loading-icon","loading"]),y("div",oe,[d(x,{class:"tree",data:l.value,props:n,load:F,lazy:"",onNodeClick:H},{default:i(({node:p,data:w})=>[y("span",se,[y("span",null,U(p.label),1),y("span",null,[w.isLeaf?(r(),j(g,{key:0,title:"确定要删除此文件吗?",onConfirm:q(D=>E(p,w),["stop"])},{reference:i(()=>[d(u,{link:"",type:"primary",style:{"margin-left":"8px"}},{default:i(()=>[S(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])):(r(),f("a",{key:1,onClick:D=>P(p,w)}," 添加目录 ",8,ce))])])]),_:1},8,["data"]),d(I,{class:"ImageSelecter-card"},{header:i(()=>{var p;return[S(U(((p=o.value)==null?void 0:p.name)||""),1)]}),footer:i(()=>[S(U(h.value),1)]),default:i(()=>[d(b,{src:v.value,style:{width:"100%"},"preview-src-list":[v.value]},{error:i(()=>[y("div",re,[d(k,null,{default:i(()=>[d(L(z))]),_:1})])]),_:1},8,["src","preview-src-list"])]),_:1})])])}}});const ie=C(le,[["__scopeId","data-v-b113f13e"],["__file","D:/work/static-service/front/src/components/ImageSelecter/index.vue"]]),de=(a,t)=>{const n=a.__vccOpts||a;for(const[o,e]of t)n[o]=e;return n},ue={name:"GeneralUpload",components:{ElUpload:G},data(){return{loading:!1}},props:{incomeForm:{type:Object,default:{}},prop:{type:String,default:""},uploadFunction:{type:Function,default:()=>{}},prompt:{type:String,default:""}},methods:{async beforeUpload(a){this.loading=!0;const t=await this.uploadFunction(a,this.prop);return this.loading=!1,t}}},_e=["src"],pe={key:1},me={class:"icon-box"},fe={key:0,class:"el-icon-loading avatar-uploader-icon"},ve={key:1,class:"el-icon-plus avatar-uploader-icon"};function he(a,t,n,o,e,l){const _=m("ElUpload");return r(),j(_,J({class:"avatar-uploader",action:"//","before-upload":l.beforeUpload,"show-file-list":!1,disabled:e.loading},a.$attrs),{default:i(()=>[n.incomeForm[n.prop]?(r(),f("img",{key:0,src:n.incomeForm[n.prop],class:"avatar"},null,8,_e)):(r(),f("span",pe,[y("div",me,[e.loading?(r(),f("i",fe)):(r(),f("i",ve))]),S(" "+U(n.prompt||"上传照片"),1)]))]),_:1},16,["before-upload","disabled"])}const ge=de(ue,[["render",he],["__scopeId","data-v-5ea78cc9"]]),ye=ge,$e={class:"Home-content"},xe=O({__name:"Home",setup(a){const t="/static-service/assets",n=M(),o=async e=>{var c,s;const{path:l="",isLeaf:_,name:v=""}=((c=n.value)==null?void 0:c.imgData)||{},h=new FormData;h.append("file",e);const F=`${l}${_||v==="文件根目录"?"":"/"+v}`,H=await fetch(`${t}?filePath=${F}`,{method:"post",body:h}),$=await H.json(),{message:P=""}=$;N(P);const{status:E=200}=H;return E===200&&((s=n.value)==null||s.refresh()),$};return(e,l)=>(r(),j(ne,null,{default:i(()=>[y("div",$e,[d(L(ye),{uploadFunction:o,drag:"",class:"upload",prompt:"将文件拖到此处或点击上传"}),d(ie,{ref_key:"ImageSelecterRef",ref:n},null,512)])]),_:1}))}});const Ie=C(xe,[["__scopeId","data-v-2dc54a20"],["__file","D:/work/static-service/front/src/views/Home.vue"]]);export{Ie as default};
