import{o as l,e as f,r as m,f as d,g as R,F as T,h as O,j as F,k as B,w as i,l as C,u as M,m as V,n as y,t as P,c as N,p as q,q as z,E as j,s as A,v as G}from"./vendor-adcf46f0.js";import{_ as U}from"./index-e91b2f62.js";const J={props:{activeIndex:String},methods:{handleSelect(a,t){this.$emit("update:activeIndex",a)}}},K={class:"head"};function Q(a,t,n,o,e,r){return l(),f("h1",K,"静态文件上传下载服务")}const W=U(J,[["render",Q],["__scopeId","data-v-0b70ddd2"]]),X={methods:{handleOpen(a,t){console.log(a,t)},handleClose(a,t){console.log(a,t)}}};function Y(a,t,n,o,e,r){return l(),f("p")}const Z=U(X,[["render",Y]]),ee={data(){return{activeIndex:"1",mainHeight:window.innerHeight-61}},name:"MainLayout",components:{HeaderMenu:W,AsideMenu:Z}};function te(a,t,n,o,e,r){const u=m("aside-menu"),v=m("header-menu");return l(),f(T,null,[d(u,{activeIndex:e.activeIndex,"onUpdate:activeIndex":t[0]||(t[0]=h=>e.activeIndex=h)},null,8,["activeIndex"]),d(v,{activeIndex:e.activeIndex,"onUpdate:activeIndex":t[1]||(t[1]=h=>e.activeIndex=h)},null,8,["activeIndex"]),R(a.$slots,"default")],64)}const ae=U(ee,[["render",te]]),ne={class:"ImageSelecter-content"},oe={class:"custom-tree-node"},se=["onClick"],ce={class:"image-slot"},le=O({__name:"index",setup(a,{expose:t}){const n={label:"name",isLeaf:"isLeaf",children:"children"},o=F(),e=F(),r=F([{name:"文件根目录"}]),u="/assets",v=B(()=>{var c,s,p;return`${u}${(c=o.value)!=null&&c.basePath?(s=o.value)==null?void 0:s.basePath.replace(/\\/gm,"/"):""}/${((p=o.value)==null?void 0:p.name)||""}`}),h=B(()=>v.value),H=async(c,s)=>{const{data:p,level:g}=c;if(g===0)return s([{name:"文件根目录"}]);const{path:x="",name:I=""}=p;e.value=!0;const b=await fetch(`${u}/assetsDir?filePath=${x}&name=${I==="文件根目录"?"":I}`,{method:"get"}),k=await b.json();e.value=!1;const{data:_={}}=k,{status:w=200}=b;if(w!==200){const{message:S=""}=k;j(S)}if(_){const{fileObjs:S=[]}=_;s(S)}else s([])},D=async(c,s,p,g)=>{o.value=c},$=()=>{e.value=!0,o.value=null,r.value=[...r.value],e.value=!1},E=(c,s)=>{console.log(c),console.log(s)},L=async(c,s)=>{const{path:p="",name:g=""}=s;e.value=!0;const x=await fetch(`${u}?filePath=${p}&name=${g==="文件根目录"?"":g}`,{method:"delete"}),I=await x.json();e.value=!1;const{message:b=""}=I;j(b);const{status:k=200}=x;k===200&&$()};return t({imgData:o,refresh:$}),(c,s)=>{const p=m("el-button"),g=m("el-popconfirm"),x=m("el-tree"),I=m("el-icon"),b=m("el-image"),k=m("el-card");return l(),f("div",null,[d(p,{class:"refresh",type:"primary","loading-icon":M(V),loading:e.value,onClick:$},{default:i(()=>[C("刷新")]),_:1},8,["loading-icon","loading"]),y("div",ne,[d(x,{class:"tree",data:r.value,props:n,load:H,lazy:"",onNodeClick:D},{default:i(({node:_,data:w})=>[y("span",oe,[y("span",null,P(_.label),1),y("span",null,[w.isLeaf?(l(),N(g,{key:0,title:"确定要删除此文件吗?",onConfirm:q(S=>L(_,w),["stop"])},{reference:i(()=>[d(p,{link:"",type:"primary",style:{"margin-left":"8px"}},{default:i(()=>[C(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])):(l(),f("a",{key:1,onClick:S=>E(_,w)}," 添加目录 ",8,se))])])]),_:1},8,["data"]),d(k,{class:"ImageSelecter-card"},{header:i(()=>{var _;return[C(P(((_=o.value)==null?void 0:_.name)||""),1)]}),footer:i(()=>[C(P(h.value),1)]),default:i(()=>[d(b,{src:v.value,style:{width:"100%"},"preview-src-list":[v.value]},{error:i(()=>[y("div",ce,[d(I,null,{default:i(()=>[d(M(z))]),_:1})])]),_:1},8,["src","preview-src-list"])]),_:1})])])}}});const re=U(le,[["__scopeId","data-v-9d78a88f"]]),ie=(a,t)=>{const n=a.__vccOpts||a;for(const[o,e]of t)n[o]=e;return n},de={name:"GeneralUpload",components:{ElUpload:A},data(){return{loading:!1}},props:{incomeForm:{type:Object,default:{}},prop:{type:String,default:""},uploadFunction:{type:Function,default:()=>{}},prompt:{type:String,default:""}},methods:{async beforeUpload(a){this.loading=!0;const t=await this.uploadFunction(a,this.prop);return this.loading=!1,t}}},pe=["src"],ue={key:1},_e={class:"icon-box"},me={key:0,class:"el-icon-loading avatar-uploader-icon"},fe={key:1,class:"el-icon-plus avatar-uploader-icon"};function ve(a,t,n,o,e,r){const u=m("ElUpload");return l(),N(u,G({class:"avatar-uploader",action:"//","before-upload":r.beforeUpload,"show-file-list":!1,disabled:e.loading},a.$attrs),{default:i(()=>[n.incomeForm[n.prop]?(l(),f("img",{key:0,src:n.incomeForm[n.prop],class:"avatar"},null,8,pe)):(l(),f("span",ue,[y("div",_e,[e.loading?(l(),f("i",me)):(l(),f("i",fe))]),C(" "+P(n.prompt||"上传照片"),1)]))]),_:1},16,["before-upload","disabled"])}const he=ie(de,[["render",ve],["__scopeId","data-v-5ea78cc9"]]),ge=he,ye={class:"Home-content"},$e=O({__name:"Home",setup(a){const t="/assets",n=F(),o=async e=>{var c,s;const{path:r="",isLeaf:u,name:v=""}=((c=n.value)==null?void 0:c.imgData)||{},h=new FormData;h.append("file",e);const H=`${r}${u||v==="文件根目录"?"":"/"+v}`,D=await fetch(`${t}?filePath=${H}`,{method:"post",body:h}),$=await D.json(),{message:E=""}=$;j(E);const{status:L=200}=D;return L===200&&((s=n.value)==null||s.refresh()),$};return(e,r)=>(l(),N(ae,null,{default:i(()=>[y("div",ye,[d(M(ge),{uploadFunction:o,drag:"",class:"upload",prompt:"将文件拖到此处或点击上传"}),d(re,{ref_key:"ImageSelecterRef",ref:n},null,512)])]),_:1}))}});const be=U($e,[["__scopeId","data-v-a49eacde"]]);export{be as default};
